{"ast":null,"code":"import _regeneratorRuntime from\"/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Card,Button,Upload,message}from'antd';import{UploadOutlined}from'@ant-design/icons';import{getFileName,upload}from'../../../axios/api';var UploadWork=function UploadWork(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),fileList=_useState2[0],setFileList=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),uploading=_useState4[0],setUploading=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),fileName=_useState6[0],setFileName=_useState6[1];//初始化数据\nuseEffect(function(){toGetFileName();},[]);//获取文件名以及格式\nvar toGetFileName=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$getFileName,status,data,msg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getFileName();case 3:_yield$getFileName=_context.sent;status=_yield$getFileName.status;data=_yield$getFileName.data;msg=_yield$getFileName.msg;if(status=='200'){setFileName(data);}else{message.error(msg);}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);message.error('请求文件名称接口失败');case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function toGetFileName(){return _ref.apply(this,arguments);};}();//上传文件的接口\nvar toUpload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formdata){var _yield$upload,status,msg;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return upload(formdata);case 3:_yield$upload=_context2.sent;status=_yield$upload.status;msg=_yield$upload.msg;if(status==='200'){setFileList([]);setUploading(false);message.success('上传成功');}else{message.error(msg);setUploading(false);}_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);message.error('请求上传接口失败');setUploading(false);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function toUpload(_x){return _ref2.apply(this,arguments);};}();var props={onRemove:function onRemove(file){var index=fileList.indexOf(file);var newFileList=fileList.slice();newFileList.splice(index,1);setFileList(newFileList);},beforeUpload:function beforeUpload(file){setFileList([file]);return false;},fileList:fileList};var handleUpload=function handleUpload(){setUploading(true);var formData=new FormData();fileList.forEach(function(file){formData.append('file',file);});toUpload(formData);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h3\",null,\"\\u4E0A\\u4F20\\u4F5C\\u4E1A\"),/*#__PURE__*/React.createElement(Card,{title:\"\\u4E0A\\u4F20\\u8981\\u6C42\",style:{width:'100%',marginBottom:'50px'}},/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'center'}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:'14px',fontWeight:'bold'}},\"\\u672C\\u6B21\\u4E0A\\u4F20\\u7684\\u4F5C\\u4E1A\\uFF1A\"),/*#__PURE__*/React.createElement(\"span\",{style:{color:'red'}},fileName.content)),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:'14px',fontWeight:'bold'}},\"\\u547D\\u540D\\u65B9\\u5F0F\\uFF1A\"),/*#__PURE__*/React.createElement(\"span\",{style:{color:'red'}},fileName.format)))),/*#__PURE__*/React.createElement(Card,{title:\"\\u4E0A\\u4F20\\u5185\\u5BB9\"},/*#__PURE__*/React.createElement(Upload,props,/*#__PURE__*/React.createElement(Button,null,/*#__PURE__*/React.createElement(UploadOutlined,null),\"  \\u4E0A\\u4F20\")),/*#__PURE__*/React.createElement(Button,{type:\"primary\",onClick:handleUpload,disabled:fileList.length===0,loading:uploading,style:{marginTop:16}},uploading?'上传中':'开始上传')));};export default UploadWork;","map":{"version":3,"sources":["/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/src/page/upload/uploadWork/index.jsx"],"names":["React","useState","useEffect","Card","Button","Upload","message","UploadOutlined","getFileName","upload","UploadWork","fileList","setFileList","uploading","setUploading","fileName","setFileName","toGetFileName","status","data","msg","error","toUpload","formdata","success","props","onRemove","file","index","indexOf","newFileList","slice","splice","beforeUpload","handleUpload","formData","FormData","forEach","append","width","marginBottom","textAlign","fontSize","fontWeight","color","content","format","length","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Card, Button, Upload, message } from 'antd'\nimport { UploadOutlined } from '@ant-design/icons';\nimport { getFileName, upload } from '../../../axios/api'\n\nconst UploadWork = () => {\n    const [fileList, setFileList] = useState([])\n    const [uploading, setUploading] = useState(false)\n    const [fileName, setFileName] = useState({})\n\n    //初始化数据\n    useEffect(() => {\n        toGetFileName()\n    }, [])\n\n    //获取文件名以及格式\n    const toGetFileName = async () => {\n        try {\n            let { status, data, msg } = await getFileName()\n            if (status == '200') {\n                setFileName(data)\n            } else {\n                message.error(msg)\n            }\n        } catch (e) {\n            message.error('请求文件名称接口失败')\n        }\n    }\n\n    //上传文件的接口\n    const toUpload = async (formdata) => {\n        try {\n            let { status, msg } = await upload(formdata)\n            if (status === '200') {\n                setFileList([])\n                setUploading(false)\n                message.success('上传成功')\n            } else {\n                message.error(msg)\n                setUploading(false)\n            }\n        } catch (e) {\n            message.error('请求上传接口失败')\n            setUploading(false)\n        }\n    }\n\n    const props = {\n        onRemove: file => {\n            const index = fileList.indexOf(file);\n            const newFileList = fileList.slice();\n            newFileList.splice(index, 1)\n            setFileList(newFileList)\n        },\n        beforeUpload: file => {\n            setFileList([file])\n            return false;\n        },\n        fileList,\n    };\n\n    const handleUpload = () => {\n        setUploading(true)\n        const formData = new FormData();\n        fileList.forEach(file => {\n            formData.append('file', file);\n        })\n        toUpload(formData)\n    }\n\n    return <React.Fragment>\n        <h3>上传作业</h3>\n        <Card title='上传要求' style={{ width: '100%', marginBottom: '50px' }}>\n            <div style={{ textAlign: 'center' }}>\n                <div>\n                    <span style={{ fontSize: '14px', fontWeight: 'bold' }}>本次上传的作业：</span>\n                    <span style={{ color: 'red' }}>{fileName.content}</span>\n                </div>\n                <div>\n                    <span style={{ fontSize: '14px', fontWeight: 'bold' }}>命名方式：</span>\n                    <span style={{ color: 'red' }}>{fileName.format}</span>\n                </div>\n            </div>\n        </Card>\n        <Card title='上传内容'>\n            <Upload {...props}>\n                <Button>\n                    <UploadOutlined />  上传\n                </Button>\n            </Upload>\n            <Button\n                type=\"primary\"\n                onClick={handleUpload}\n                disabled={fileList.length === 0}\n                loading={uploading}\n                style={{ marginTop: 16 }}\n            >\n                {uploading ? '上传中' : '开始上传'}\n            </Button>\n        </Card>\n    </React.Fragment>\n}\n\nexport default UploadWork"]},"metadata":{},"sourceType":"module"}