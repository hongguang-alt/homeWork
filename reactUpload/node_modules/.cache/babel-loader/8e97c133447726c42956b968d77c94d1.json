{"ast":null,"code":"var _jsxFileName = \"/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/src/page/upload/manager/index.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport moment from 'moment';\nimport { Card, Button, Table, Space, Modal, Form, Input, message } from 'antd';\nimport { noHomeWorkListName, changeFileFormat, detailList, deleteAll, deteleOne } from '../../../axios/api';\nconst {\n  confirm\n} = Modal;\n\nconst Manager = () => {\n  const [noHomeWorkList, setNoHomeWorkList] = useState([]);\n  const [dataSource, setDataSource] = useState([]);\n  const [form] = Form.useForm();\n  useEffect(() => {\n    getNoHomeWorkList();\n    getDetailList();\n  }, []);\n\n  const onFinish = value => {\n    toChangeFileFormat(value);\n    form.resetFields();\n  }; //获取全部文件\n\n\n  const getAllFile = async () => {\n    window.location.assign123('http://localhost:3001/file/downloadall');\n  }; //修改文件名称的接口\n\n\n  const toChangeFileFormat = async param => {\n    try {\n      let {\n        msg,\n        status\n      } = await changeFileFormat(param);\n\n      if (status == '200') {\n        message.success('修改成功');\n      } else {\n        message.error(msg);\n      }\n    } catch (e) {\n      console.log(e);\n      message.error(\"访问修改接口失败\");\n    }\n  }; //获取未完成作业的列表\n\n\n  const getNoHomeWorkList = async () => {\n    try {\n      let {\n        data,\n        status,\n        msg\n      } = await noHomeWorkListName();\n\n      if (status == '200') {\n        message.success('获取未完成作业列表成功');\n        setNoHomeWorkList(data.data);\n      } else {\n        message.error(msg);\n      }\n    } catch (e) {\n      console.log(e);\n      message.error('获取未完成作业接口失败');\n    }\n  }; //获取文件详情数据的接口\n\n\n  const getDetailList = async () => {\n    try {\n      let {\n        data,\n        status,\n        msg\n      } = await detailList();\n\n      if (status == '200') {\n        message.success('获取列表成功');\n        setDataSource(data.data);\n      } else {\n        message.error(msg);\n      }\n    } catch (e) {}\n  };\n\n  const columns = [{\n    title: '姓名',\n    dataIndex: 'name',\n    key: 'name'\n  }, {\n    title: '学号',\n    dataIndex: 'sid',\n    key: 'sid',\n    sorter: (a, b) => Number(a.sid) - b.sid\n  }, {\n    title: '文件名称',\n    dataIndex: 'fileName',\n    key: 'fileName'\n  }, {\n    title: '提交时间',\n    dataIndex: 'ctime',\n    key: 'ctime',\n    sorter: (a, b) => a.ctime - b.ctime,\n    render: text => {\n      return moment(text).format('YYYY-MM-DD HH:mm:ss');\n    }\n  }, {\n    title: '操作',\n    dataIndex: 'action',\n    key: 'action',\n    render: (text, record) => {\n      return /*#__PURE__*/React.createElement(Space, {\n        size: \"middle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 24\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: () => toDeleteData(record),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }\n      }, \"\\u5220\\u9664\"), /*#__PURE__*/React.createElement(\"a\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }\n      }, \"\\u5BFC\\u51FA\"));\n    }\n  }];\n  const layout = {\n    labelCol: {\n      span: 6\n    },\n    wrapperCol: {\n      span: 16\n    }\n  };\n  const tailLayout = {\n    wrapperCol: {\n      offset: 10,\n      span: 14\n    }\n  };\n\n  const toDeleteData = record => {\n    confirm({\n      title: '确定删除这条数据?',\n      okText: \"确认\",\n      cancelText: \"取消\",\n      onOk: async () => {\n        try {\n          const {\n            status,\n            msg\n          } = await deteleOne({\n            name: record.fileName\n          });\n\n          if (status == '200') {\n            message.success('删除文档成功');\n            getDetailList();\n            getNoHomeWorkList();\n          } else {\n            message.error(msg);\n          }\n        } catch (e) {\n          console.log(e);\n          message.error('删除单个接口失败');\n        }\n      },\n\n      onCancel() {\n        console.log('Cancel');\n      }\n\n    });\n  };\n\n  const toDeleteAll = () => {\n    confirm({\n      title: '确定清空数据?',\n      okText: \"确认\",\n      cancelText: \"取消\",\n      onOk: async () => {\n        try {\n          const {\n            status,\n            msg\n          } = await deleteAll();\n\n          if (status == '200') {\n            message.success('删除全部文档成功');\n            getDetailList();\n            getNoHomeWorkList();\n          } else {\n            message.error(msg);\n          }\n        } catch (e) {\n          message.error('删除全部接口失败');\n        }\n      },\n\n      onCancel() {\n        console.log('Cancel');\n      }\n\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  }, \"\\u7BA1\\u7406\\u4F5C\\u4E1A\"), /*#__PURE__*/React.createElement(Card, {\n    title: \"\\u4F5C\\u4E1A\\u672A\\u4E0A\\u4EA4\\u540D\\u5355\",\n    style: {\n      marginBottom: '50px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 17\n    }\n  }, Array.isArray(noHomeWorkList) ? noHomeWorkList.map((item, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      style: {\n        width: '50px',\n        textAlign: 'center',\n        color: 'red'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 36\n      }\n    }, item);\n  }) : null)), /*#__PURE__*/React.createElement(Card, {\n    title: \"\\u4F5C\\u4E1A\\u5185\\u5BB9\",\n    style: {\n      marginBottom: '50px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '600px',\n      margin: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form, Object.assign({}, layout, {\n    name: \"basic\",\n    onFinish: onFinish,\n    form: form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"\\u4E0A\\u4F20\\u4F5C\\u4E1A\\u5185\\u5BB9\",\n    name: \"content\",\n    rules: [{\n      required: true,\n      message: '请输入作业内容'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"\\u547D\\u540D\\u683C\\u5F0F\",\n    name: \"format\",\n    rules: [{\n      required: true,\n      message: '请输入命名格式'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, Object.assign({}, tailLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 29\n    }\n  }, \"\\u63D0\\u4EA4\"))))), /*#__PURE__*/React.createElement(Card, {\n    title: \"\\u4F5C\\u4E1A\\u5217\\u8868\",\n    extra: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        fontSize: \"14px\"\n      },\n      onClick: getAllFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }\n    }, \"\\u5168\\u90E8\\u5BFC\\u51FA\"), /*#__PURE__*/React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        fontSize: \"14px\",\n        marginLeft: '10px'\n      },\n      onClick: toDeleteAll,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 21\n      }\n    }, \"\\u6E05\\u7A7A\\u6570\\u636E\")),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    dataSource: dataSource,\n    columns: columns,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default Manager;","map":{"version":3,"sources":["/Users/wanghongguang/Desktop/homework/reactUpload/reactupload/src/page/upload/manager/index.jsx"],"names":["React","useEffect","useState","moment","Card","Button","Table","Space","Modal","Form","Input","message","noHomeWorkListName","changeFileFormat","detailList","deleteAll","deteleOne","confirm","Manager","noHomeWorkList","setNoHomeWorkList","dataSource","setDataSource","form","useForm","getNoHomeWorkList","getDetailList","onFinish","value","toChangeFileFormat","resetFields","getAllFile","window","location","assign123","param","msg","status","success","error","e","console","log","data","columns","title","dataIndex","key","sorter","a","b","Number","sid","ctime","render","text","format","record","toDeleteData","layout","labelCol","span","wrapperCol","tailLayout","offset","okText","cancelText","onOk","name","fileName","onCancel","toDeleteAll","marginBottom","display","flexWrap","Array","isArray","map","item","index","width","textAlign","color","margin","required","fontSize","marginLeft"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport moment from 'moment'\nimport { Card, Button, Table, Space, Modal, Form, Input, message } from 'antd'\nimport { noHomeWorkListName, changeFileFormat, detailList, deleteAll, deteleOne } from '../../../axios/api'\nconst { confirm } = Modal;\n\n\n\nconst Manager = () => {\n    const [noHomeWorkList, setNoHomeWorkList] = useState([])\n    const [dataSource, setDataSource] = useState([])\n    const [form] = Form.useForm()\n\n    useEffect(() => {\n        getNoHomeWorkList()\n        getDetailList()\n    }, [])\n\n    const onFinish = (value) => {\n        toChangeFileFormat(value)\n        form.resetFields()\n\n    }\n\n    //获取全部文件\n    const getAllFile = async () => {\n        window.location.assign123('http://localhost:3001/file/downloadall')\n    }\n\n\n    //修改文件名称的接口\n    const toChangeFileFormat = async (param) => {\n        try {\n            let { msg, status } = await changeFileFormat(param)\n            if (status == '200') {\n                message.success('修改成功')\n            } else {\n                message.error(msg)\n            }\n        } catch (e) {\n            console.log(e)\n            message.error(\"访问修改接口失败\")\n        }\n    }\n\n\n    //获取未完成作业的列表\n    const getNoHomeWorkList = async () => {\n        try {\n            let { data, status, msg } = await noHomeWorkListName()\n            if (status == '200') {\n                message.success('获取未完成作业列表成功')\n                setNoHomeWorkList(data.data)\n            } else {\n                message.error(msg)\n            }\n        } catch (e) {\n            console.log(e)\n            message.error('获取未完成作业接口失败')\n        }\n    }\n\n    //获取文件详情数据的接口\n    const getDetailList = async () => {\n        try {\n            let { data, status, msg } = await detailList()\n            if (status == '200') {\n                message.success('获取列表成功')\n                setDataSource(data.data)\n            } else {\n                message.error(msg)\n            }\n        } catch (e) {\n\n        }\n    }\n\n\n    const columns = [\n        {\n            title: '姓名',\n            dataIndex: 'name',\n            key: 'name',\n        },\n        {\n            title: '学号',\n            dataIndex: 'sid',\n            key: 'sid',\n            sorter: (a, b) =>Number(a.sid) - b.sid\n        }, {\n            title: '文件名称',\n            dataIndex: 'fileName',\n            key: 'fileName'\n        },\n        {\n            title: '提交时间',\n            dataIndex: 'ctime',\n            key: 'ctime',\n            sorter: (a, b) => a.ctime - b.ctime,\n            render: (text) => {\n                return moment(text).format('YYYY-MM-DD HH:mm:ss')\n            }\n        },\n        {\n            title: '操作',\n            dataIndex: 'action',\n            key: 'action',\n            render: (text, record) => {\n                return <Space size=\"middle\">\n                    <a onClick={() => toDeleteData(record)}>删除</a>\n                    <a>导出</a>\n                </Space>\n            }\n        }\n    ];\n\n    const layout = {\n        labelCol: {\n            span: 6,\n        },\n        wrapperCol: {\n            span: 16,\n        },\n    }\n    const tailLayout = {\n        wrapperCol: {\n            offset: 10,\n            span: 14,\n        },\n    }\n\n    const toDeleteData = (record) => {\n        confirm({\n            title: '确定删除这条数据?',\n            okText: \"确认\",\n            cancelText: \"取消\",\n            onOk: async () => {\n                try {\n                    const { status, msg } = await deteleOne({ name: record.fileName })\n                    if (status == '200') {\n                        message.success('删除文档成功')\n                        getDetailList()\n                        getNoHomeWorkList()\n                    } else {\n                        message.error(msg)\n                    }\n                } catch (e) {\n                    console.log(e)\n                    message.error('删除单个接口失败')\n                }\n\n            },\n            onCancel() {\n                console.log('Cancel');\n            },\n        });\n    }\n\n    const toDeleteAll = () => {\n        confirm({\n            title: '确定清空数据?',\n            okText: \"确认\",\n            cancelText: \"取消\",\n            onOk: async () => {\n                try {\n                    const { status, msg } = await deleteAll()\n                    if (status == '200') {\n                        message.success('删除全部文档成功')\n                        getDetailList()\n                        getNoHomeWorkList()\n                    } else {\n                        message.error(msg)\n                    }\n                } catch (e) {\n                    message.error('删除全部接口失败')\n                }\n            },\n            onCancel() {\n                console.log('Cancel');\n            },\n        });\n    }\n\n    return (\n        <React.Fragment>\n            <h3>管理作业</h3>\n            <Card title='作业未上交名单' style={{ marginBottom: '50px' }} >\n                <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n                    {\n                        Array.isArray(noHomeWorkList) ? noHomeWorkList.map((item, index) => {\n                            return <div key={index} style={{ width: '50px', textAlign: 'center', color: 'red' }}>{item}</div>\n                        }) : null\n                    }\n                </div>\n            </Card>\n            <Card title='作业内容' style={{ marginBottom: '50px' }}>\n                <div style={{ width: '600px', margin: 'auto' }}>\n                    <Form\n                        {...layout}\n                        name=\"basic\"\n                        onFinish={onFinish}\n                        form={form}\n                    >\n                        <Form.Item\n                            label=\"上传作业内容\"\n                            name=\"content\"\n                            rules={[{ required: true, message: '请输入作业内容' }]}\n                        >\n                            <Input />\n                        </Form.Item>\n\n                        <Form.Item\n                            label=\"命名格式\"\n                            name=\"format\"\n                            rules={[{ required: true, message: '请输入命名格式' }]}\n                        >\n                            <Input />\n                        </Form.Item>\n                        <Form.Item {...tailLayout}>\n                            <Button type=\"primary\" htmlType=\"submit\">\n                                提交\n                        </Button>\n                        </Form.Item>\n                    </Form>\n                </div>\n            </Card>\n            <Card title='作业列表' extra={\n                <div>\n                    <Button type='primary' style={{ fontSize: \"14px\" }} onClick={getAllFile}>全部导出</Button>\n                    <Button type='primary' style={{ fontSize: \"14px\", marginLeft: '10px' }} onClick={toDeleteAll}>清空数据</Button>\n                </div>}>\n                <Table dataSource={dataSource} columns={columns} />\n            </Card>\n        </React.Fragment>\n    )\n}\n\nexport default Manager"]},"metadata":{},"sourceType":"module"}